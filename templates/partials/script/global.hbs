{{!< default}}
{{!-- 
/**
 * Uncertainty Project
 * Developed by Engagement Lab, 2016
 * ==============
 * 
 * Script include for global logic
 * ==========
 */
--}}

<script type="text/javascript">

var socket;
var socketEvents;
var gameCode;

$(document).ready(function() {

	$('#btn_login').click(function(evt) {
		var data = {};
		data.email = $('#email_input').val();
		data.password = $('#password_input').val();
		console.log(data);

		if (!data.password || !data.email) {
			console.log ("empty fields");
			  
		} else {
			console.log("checking login info");

			$.get("/api/find/", data, function(data){
				window.location = data;
			})
			.fail(function() {
			    alert( "error" );
			});
		}

	});


	var points = 0;

	$('#tinderslide').jTinder({
		onDislike: function (item) {
        CheckTrash(item);
    },
    onLike: function (item) {
        CheckRecycle(item);
    },
    animationRevertSpeed: 200,
    animationSpeed: 400,
    threshold: 1,
    likeSelector: '#recycle',
    dislikeSelector: '#trash'
  });

	// If a player chooses to trash an item
  $('#trash').click(function() {
  	$('#tinderslide').jTinder('dislike');
  });

  function CheckTrash(item) {
  	// check if item is trash
  	if (item.hasClass('Trash')) {
  		console.log('CORRECT - dis trash');
  		UpdateScore(1);
  	} else {
  		UpdateScore(-1);
  		console.log ('WRONG - dis recyclable');
  	}
  }

  // If a player chooses to recycle
  $('#recycle').click(function() {
  	$('#tinderslide').jTinder('like');
  });

  function CheckRecycle(item) {
  	// check if item is recyclable
  	if (item.hasClass('Recycle')) {
  		UpdateScore(1);
  		console.log('CORRECT - dis recyclable');

  	} else {
  		UpdateScore(-1);
  		console.log ('WRONG - dis trash');
  	}
  }

  function UpdateScore(num) {
  	points = points + num;

  	console.log(points);

  	$('#points-counter').html(points);

  }


});




// Leftover Code -- Will Be Removed Later




	// var timeline = new TimelineMax();
	$(document).ready(function() {

		// Menu toggling
	  $("#menu-close").click(function(e) {
	    e.preventDefault();
	    $("#sidebar-wrapper").toggleClass("active");
	  });
	  $("#menu-toggle").click(function(e) {
	    e.preventDefault();
	    $("#sidebar-wrapper").toggleClass("active");
	  });

	  {{#ifeq section "index"}}

		  // Blurring/no blur
		  $('.category').hover(
		  	function () {
			    $(this).children('.bg').removeClass("blur");
			    $(this).children('.content').addClass("transparent");
			  },
			  function () {
			    $(this).children('.bg').addClass("blur");
			    $(this).children('.content').removeClass("transparent");
			  }
		  );
			var timeline = TweenMax.to({}, 5, 
			{
				repeat: -1,
				yoyo: true,
				onRepeat:function(){
					timeline.duration(Math.floor(Math.random() * (10 - 1 + 1)) + 1)
				},
			  onUpdateParams:["{self}"],
			  onUpdate:function(tl){

			    var tlp = (tl.progress()*9);
			    TweenMax.set('#blurred',{'-webkit-filter':'blur(' + tlp + 'px' + ')','filter':'blur(' + tlp + 'px' + ')'});
			  }
			});

		{{/ifeq}}

		{{#ifeq section "category"}}

      $("#title").lettering('words');

      // display image caption on top of image
			$("#body img").each(function() {
					$(this).wrap('<figure class="image"></figure>')
			    var imageCaption = $(this).attr("alt");
			    if (imageCaption != '') {
			        $("<figcaption>" + imageCaption +"</figure>").insertAfter(this);
			    }
			});

		{{/ifeq}}

	});
	
</script>